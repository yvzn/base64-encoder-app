<Window x:Class="Base64Utils.MainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:local="clr-namespace:Base64Utils"
mc:Ignorable="d"
Title="Base64 Converter" Height="600" Width="800">
    <Window.Resources>
        <Color x:Key="EncodeAccentColor">#0078D4</Color>
        <Color x:Key="DecodeAccentColor">#107C10</Color>
        <SolidColorBrush x:Key="EncodeAccentBrush" Color="{StaticResource EncodeAccentColor}"/>
        <SolidColorBrush x:Key="DecodeAccentBrush" Color="{StaticResource DecodeAccentColor}"/>

        <Storyboard x:Key="SpinnerAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="SpinnerRotation"
                           Storyboard.TargetProperty="Angle"
                           From="0" To="360" Duration="0:0:1"/>
        </Storyboard>
        
        <!-- Enhanced focus visual style for better visibility -->
        <Style x:Key="EnhancedFocusButtonStyle" TargetType="Button">
            <Setter Property="FocusVisualStyle">
                <Setter.Value>
                    <Style>
                        <Setter Property="Control.Template">
                            <Setter.Value>
                                <ControlTemplate>
                                    <Rectangle Margin="-5" 
                                             StrokeThickness="2" 
                                             Stroke="#999999"
                                             StrokeDashArray="1 1"
                                             SnapsToDevicePixels="True"/>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="32"/>
        </Grid.RowDefinitions>

        <TabControl x:Name="ModeTabControl"
                    Grid.Row="0"
                    Margin="10,10,10,10"
                    SelectionChanged="ModeTabControl_SelectionChanged">
            <TabItem x:Name="EncodeTab">
                <TabItem.Header>
                    <StackPanel>
                        <Rectangle Height="4" Fill="{StaticResource EncodeAccentBrush}" RadiusX="2" RadiusY="2"/>
                        <TextBlock Text="Encode" FontSize="14" Margin="0,6,0,0" FontWeight="SemiBold"/>
                    </StackPanel>
                </TabItem.Header>
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Top" Width="700" Margin="10">
                        <Grid Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <Button x:Name="SelectFileButton" 
                                    Grid.Column="0"
                                    Content="Select File" 
                                    Height="40" 
                                    Width="120"
                                    Margin="0,0,10,0"
                                    FontSize="16"
                                    Style="{StaticResource EnhancedFocusButtonStyle}"
                                    Click="SelectFileButton_Click"/>
                            
                            <TextBlock x:Name="FileNameTextBlock" 
                                       Grid.Column="1"
                                       Text="No file selected." 
                                       VerticalAlignment="Center"
                                       Margin="10,0"
                                       FontSize="14"
                                       TextWrapping="Wrap"
                                       TextTrimming="CharacterEllipsis"/>
                            
                            <Viewbox x:Name="LoadingSpinner"
                                     Grid.Column="2"
                                     Width="30"
                                     Height="30"
                                     Margin="0,0,10,0"
                                     Visibility="Collapsed">
                                <Canvas Width="100" Height="100">
                                    <Canvas.RenderTransform>
                                        <RotateTransform x:Name="SpinnerRotation" CenterX="50" CenterY="50" Angle="0"/>
                                    </Canvas.RenderTransform>
                                    <Ellipse Width="20" Height="20" Canvas.Left="40" Canvas.Top="5" Fill="#FF0078D4" Opacity="1.0"/>
                                    <Ellipse Width="20" Height="20" Canvas.Left="65" Canvas.Top="15" Fill="#FF0078D4" Opacity="0.85"/>
                                    <Ellipse Width="20" Height="20" Canvas.Left="75" Canvas.Top="40" Fill="#FF0078D4" Opacity="0.7"/>
                                    <Ellipse Width="20" Height="20" Canvas.Left="65" Canvas.Top="65" Fill="#FF0078D4" Opacity="0.55"/>
                                    <Ellipse Width="20" Height="20" Canvas.Left="40" Canvas.Top="75" Fill="#FF0078D4" Opacity="0.4"/>
                                    <Ellipse Width="20" Height="20" Canvas.Left="15" Canvas.Top="65" Fill="#FF0078D4" Opacity="0.25"/>
                                    <Ellipse Width="20" Height="20" Canvas.Left="5" Canvas.Top="40" Fill="#FF0078D4" Opacity="0.15"/>
                                    <Ellipse Width="20" Height="20" Canvas.Left="15" Canvas.Top="15" Fill="#FF0078D4" Opacity="0.05"/>
                                </Canvas>
                            </Viewbox>
                            
                            <Button x:Name="ConvertButton" 
                                    Grid.Column="3"
                                    Content="Convert to Base64" 
                                    Height="40" 
                                    Width="160"
                                    Margin="0"
                                    FontSize="16"
                                    IsEnabled="False"
                                    Style="{StaticResource EnhancedFocusButtonStyle}"
                                    Click="ConvertButton_Click"/>
                        </Grid>
                        
                        <Grid Margin="10,20,10,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0"
                                       Text="Result:" 
                                       FontSize="14"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"/>
                            
                            <Button x:Name="SaveToFileButton"
                                    Grid.Column="2"
                                    Content="Save to File"
                                    Height="30"
                                    Width="120"
                                    Margin="0,0,10,0"
                                    FontSize="12"
                                    IsEnabled="False"
                                    Style="{StaticResource EnhancedFocusButtonStyle}"
                                    Click="SaveToFileButton_Click"/>
                            
                            <Button x:Name="CopyButton"
                                    Grid.Column="3"
                                    Content="Copy to Clipboard"
                                    Height="30"
                                    Width="140"
                                    FontSize="12"
                                    IsEnabled="False"
                                    Style="{StaticResource EnhancedFocusButtonStyle}"
                                    Click="CopyButton_Click"/>
                        </Grid>
                        
                        <TextBox x:Name="ResultTextBox" 
                                 Height="300" 
                                 Margin="10"
                                 TextWrapping="Wrap"
                                 VerticalScrollBarVisibility="Auto"
                                 IsReadOnly="True"
                                 FontFamily="Consolas"
                                 FontSize="12"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem x:Name="DecodeTab">
                <TabItem.Header>
                    <StackPanel>
                        <Rectangle Height="4" Fill="{StaticResource DecodeAccentBrush}" RadiusX="2" RadiusY="2"/>
                        <TextBlock Text="Decode" FontSize="14" Margin="0,6,0,0" FontWeight="SemiBold"/>
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Border Margin="20" Padding="20" BorderBrush="#FFD6D6D6" BorderThickness="1" CornerRadius="6" Background="#FFF9F9F9">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Width="400">
                            <TextBlock Text="Decode mode" FontSize="20" FontWeight="Bold" Foreground="#FF107C10" HorizontalAlignment="Center"/>
                            <TextBlock Text="Base64 decoding tools will appear here." FontSize="14" Margin="0,10,0,0" TextAlignment="Center"/>
                            <TextBlock Text="Stay tuned — this area is reserved for upcoming decode workflows." FontSize="12" Margin="0,10,0,0" Foreground="#FF666666" TextAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>
        
        <StatusBar Grid.Row="1" Height="32" Background="#FFF5F5F5">
            <StatusBarItem>
                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Border x:Name="StatusBarAccent" Grid.Column="0" Width="8" CornerRadius="4" Background="{StaticResource EncodeAccentBrush}"/>
                    <Grid Grid.Column="1">
                        <TextBlock x:Name="StatusBarText" 
                                   Text="Ready" 
                                   Foreground="{StaticResource EncodeAccentBrush}"
                                   FontSize="14"
                                   TextTrimming="CharacterEllipsis"
                                   Cursor="Hand"
                                   Focusable="True"
                                   MouseLeftButtonDown="StatusBarText_MouseLeftButtonDown"
                                   KeyDown="StatusBarText_KeyDown"
                                   ToolTip="Press Enter or Space to expand message"/>
                        <Popup x:Name="StatusMessagePopup"
                               PlacementTarget="{Binding ElementName=StatusBarText}"
                               Placement="Top"
                               AllowsTransparency="True"
                               StaysOpen="True"
                               Opened="StatusMessagePopup_Opened">
                            <Border Background="White" 
                                    BorderBrush="#FFCCCCCC" 
                                    BorderThickness="1"
                                    Padding="10"
                                    MaxWidth="750"
                                    CornerRadius="3">
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                                </Border.Effect>
                                <Grid>
                                    <TextBlock x:Name="ExpandedMessageText"
                                               TextWrapping="Wrap"
                                               Foreground="#FF333333"
                                               FontSize="14"
                                               Margin="0,0,30,0"/>
                                    
                                    <Button x:Name="ClosePopupButton"
                                            Content="✕"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Width="20"
                                            Height="20"
                                            Margin="0,-5,-5,-5"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            FontSize="12"
                                            FontWeight="Bold"
                                            Cursor="Hand"
                                            ToolTip="Press Escape or click to close"
                                            Click="ClosePopupButton_Click"
                                            KeyDown="ClosePopupButton_KeyDown">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Foreground" Value="#FF999999"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Foreground" Value="#FFCC0000"/>
                                                        <Setter Property="Background" Value="#FFF0F0F0"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </Grid>
                            </Border>
                        </Popup>
                    </Grid>
                </Grid>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
